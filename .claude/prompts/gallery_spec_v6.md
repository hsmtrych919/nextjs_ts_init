# 【共通認識】新築マンション写真ギャラリー 詳細仕様

## プロジェクト概要
新築マンションチラシのQRコードから遷移するスマートフォン特化の写真ギャラリーサイト。素人撮影の写真を効果的に表示し、マンション見学者の興味を引く体験を提供する。

## ターゲットデバイス・画面仕様
- **メインターゲット**: スマートフォン（縦向き・横向き両対応）
- **サブターゲット**: タブレット（iPadなど）
- **対象外**: PC（QR読み取り前提のため、閲覧は可能）
- **画面サイズ対応**: 375px〜768px（スマホ）、769px〜1024px（タブレット）

## 機能仕様
### カテゴリ構成
1. **外観 (exterior)**: マンション外観、エントランス、駐車場など
2. **居室 (interior)**: リビング、キッチン、ベッドルーム、バルコニーなど  
3. **共用部 (common)**: ロビー、廊下、共用施設など

### 写真仕様
- **枚数**: 各カテゴリ5枚ずつ（合計15枚）
- **サムネイル**: 正方形（300x300px推奨）、グリッド表示用
- **フル画像**: 元の縦横比維持（最大幅800px推奨）、モーダル表示用
- **配置**: public/img/ ディレクトリ
- **形式**: JPG/PNG（WebP対応は後日検討）

### UI/UX フロー
1. **初期表示**: 外観タブが選択状態、該当写真を2列グリッドで表示
2. **タブ切り替え**: 居室・共用部タブクリックで内容切り替え
3. **写真拡大**: グリッド内写真タップでモーダル表示
4. **モーダル操作**: スワイプ・矢印・ドットで同一カテゴリ内ナビゲーション

## 技術スタック
- **フレームワーク**: React + Next.js（既存プロジェクトベース）
- **モーダル**: react-modal（既存導入済み）
- **既存コンポーネント**: ボタン、トグル等を活用
- **スタイリング**: CSS Modules + レスポンシブ対応
- **データ管理**: JSON静的ファイル

## データ構造仕様
**ファイルパス**: `public/data/gallery.json`
```json
{
  "exterior": {
    "title": "外観",
    "description": "○○駅徒歩3分の好立地。南向きで日当たり良好な新築マンションです。充実した周辺環境で快適な住環境をお約束します。",
    "images": [
      {
        "thumbnail": "/img/exterior_thumb_01.jpg",
        "full": "/img/exterior_full_01.jpg", 
        "alt": "マンション外観正面"
      }
    ]
  },
  "interior": {
    "title": "居室",
    "description": "広々としたリビングダイニングと使いやすい間取り設計。自然光がたっぷり入る明るい住空間です。",
    "images": [...]
  },
  "common": {
    "title": "共用部", 
    "description": "充実した共用施設とセキュリティ万全のエントランス。24時間管理で安心・安全な生活をサポートします。",
    "images": [...]
  }
}
```

## レスポンシブ要件
- **スマホ縦**: 2列グリッド、タッチ操作最適化
- **スマホ横**: グリッド維持、モーダルサイズ調整
- **タブレット**: 3列グリッド検討、大画面活用

---

# 【ブランチ戦略・Stage 0】開発準備

## 現在のブランチ状況
- **作業ブランチ**: `phase3_demo`（現在位置）
- **最終統合先**: `phase3_demo`（mainへのマージは行わない）

## Stage 0: ブランチ作成（両エージェント実行）

### エージェント1用ブランチ
```bash
git checkout -b phase3_demo_agent1
git push -u origin phase3_demo_agent1
```

### エージェント2用ブランチ  
```bash
git checkout -b phase3_demo_agent2
git push -u origin phase3_demo_agent2
```

**重要**: 各エージェントは独自ブランチで作業し、マージは手動で慎重に実行

---

# 【🚀 並行開発フェーズ】エージェント1 & エージェント2 同時実行

## 【エージェント1】UI・レイアウト担当（並行フェーズ）

### Stage 1: 基本レイアウト構築
**所要時間**: 15分 | **フェーズ**: 並行開発
**コミット**: "feat(ui): 基本レイアウトとタイトル追加"

#### 作業内容
```bash
# Claude Code指示例
"components/GalleryLayout.jsxを新規作成。サイトタイトル『物件写真ギャラリー』と3つのタブボタン（外観・居室・共用部）を横並び配置。スマホ向けレスポンシブデザイン適用。タブ機能は未実装でOK"
```

#### 成果物
- `components/GalleryLayout.jsx`
- 基本レイアウトCSS

#### 確認ポイント
- サイトタイトル表示確認
- 3つのタブが横並び表示
- スマホ画面での表示崩れなし

---

### Stage 2: タブ切り替え機能実装
**所要時間**: 10分 | **フェーズ**: 並行開発
**コミット**: "feat(ui): タブ切り替え状態管理追加"

#### 作業内容
```bash
# Claude Code指示例  
"useStateでアクティブタブ管理機能追加。タブクリックでstate変更、アクティブタブに視覚的フィードバック（色変更、下線など）。コンテンツエリアは空でOK"
```

#### 成果物
- タブ状態管理ロジック
- アクティブ状態のスタイリング

#### 確認ポイント
- タブクリックで見た目変化
- アクティブタブの明確な視覚表示

**Stage 2完了後**: 並行フェーズ終了、統一ポイントへ移行準備

---

## 【エージェント2】モーダル・データ担当（並行フェーズ）

### Stage 1: データ構造構築
**所要時間**: 12分 | **フェーズ**: 並行開発
**コミット**: "feat(data): ギャラリーデータ構造追加"

#### 作業内容
```bash
# Claude Code指示例
"public/data/gallery.json作成、3カテゴリ×5枚構造でダミーパス設定。utils/galleryData.js作成、JSON読み込み・パース機能実装"
```

#### 成果物
- `public/data/gallery.json`
- `utils/galleryData.js`

#### 確認ポイント
- JSONデータ読み込み成功
- カテゴリごとのデータ取得確認

---

### Stage 2: 基本モーダル表示
**所要時間**: 18分 | **フェーズ**: 並行開発
**コミット**: "feat(modal): PhotoModal基本機能追加"

#### 作業内容
```bash
# Claude Code指示例
"components/PhotoModal.jsx作成。react-modal使用、写真拡大表示、閉じるボタン、元縦横比維持。モーダル背景クリックで閉じる機能も実装"
```

#### 成果物
- `components/PhotoModal.jsx`
- モーダル専用CSS

#### 確認ポイント  
- モーダル表示・非表示
- 画像の適切な拡大表示
- 閉じる操作の動作確認

**Stage 2完了後**: 並行フェーズ終了、統一ポイント準備完了を報告

---

# 🔄【統一ポイント】エージェント2 → エージェント1 統合

## 統合タイミング
**両エージェントのStage 2完了後に実行**

## 統合手順
1. **エージェント2**: 「並行フェーズ完了、統合準備完了です」を報告
2. **人間**: エージェント2の成果物確認・承認
3. **人間**: `phase3_demo_agent2` → `phase3_demo_agent1` マージ実行
4. **エージェント1**: 統合されたブランチで統一フェーズ開始

## 統合時の注意点
- エージェント1のブランチがメインとなり、以降の開発を担当
- エージェント2の全成果物がエージェント1のコンテキストに統合される
- マージ後の動作確認を必ず実施

---

# 🎯【統一フェーズ】エージェント1 単独開発

**重要**: この時点で開発はエージェント1に一本化、複雑な機能統合を安全に実行

## Stage 3: グリッド表示と画像統合
**所要時間**: 20分 | **フェーズ**: 統一開発
**コミット**: "feat(integration): グリッド表示と画像データ統合"

### 作業内容
```bash
# Claude Code指示例
"PhotoGrid.jsxを作成し、エージェント2のデータ読み込み機能と統合。2列グリッドで実画像表示、gallery.jsonからデータ取得、正方形サムネイル表示"
```

### 成果物
- `components/PhotoGrid.jsx` 
- データ統合ロジック
- 実画像表示機能

### 確認ポイント
- JSONデータと画像の正常表示
- タブ切り替えでの画像セット変更
- レスポンシブ動作確認

---

## Stage 4: モーダル連携実装
**所要時間**: 15分 | **フェーズ**: 統一開発
**コミット**: "feat(integration): グリッドとモーダルの連携実装"

### 作業内容  
```bash
# Claude Code指示例
"グリッドの写真クリック時にPhotoModalを開く機能実装。クリックした画像情報（インデックス、カテゴリ）をモーダルに受け渡し、正しい画像を表示"
```

### 成果物
- グリッド-モーダル連携機能
- 画像情報受け渡しロジック

### 確認ポイント
- 写真クリック時のモーダル表示
- 正しい画像の拡大表示
- モーダル閉じる操作確認

---

## Stage 5: 高度ナビゲーション完成
**所要時間**: 25分 | **フェーズ**: 統一開発
**コミット**: "feat(complete): 矢印・ドット・スワイプナビゲーション完成"

### 作業内容
```bash
# Claude Code指示例
"モーダル内の全ナビゲーション機能を統合実装。矢印ボタン、ドットインジケーター、スワイプ操作を組み合わせ、同一カテゴリ内での完全な写真移動機能を完成"
```

### 成果物
- 完全なナビゲーション機能
- スワイプ検知システム
- 統合されたUX

### 確認ポイント
- 矢印・ドット・スワイプ全ての操作確認
- 境界制御の動作確認
- スムーズな操作感の確認

**Stage 5完了後**: 全機能完成、phase3_demoへの最終マージ準備完了を報告

---

# 【重要】各Stage実行フロー

## Stage開始前の確認プロセス
各エージェントは以下の手順を厳守すること：

### 1. 事前確認
```
「Stage X を実行しますか？」
- 作業内容の確認
- 前Stage完了状況の確認
- 現在のブランチ状況確認
```

**人間の承認を得てから作業開始**

### 2. 作業完了後の報告プロセス
```
「Stage X が完了しました。以下の成果物をご確認ください：
- [作成したファイル一覧]
- [実装した機能概要]  
- [確認ポイントの動作結果]

問題なければ、指定のコミットメッセージでコミットを実行いたします。」
```

**人間のチェック・承認を待つ**

### 3. コミット実行後
```
「Stage X のコミットが完了しました。

Stage X+1 を実行しますか？」
```

**次Stage実行前に再度承認を求める**

## エラー・問題発生時
- 即座に作業中断
- 問題内容を詳細報告  
- 人間の指示を待つ
- 必要に応じて前Stageにロールバック

## マージ戦略

### マージタイミング
- **Stage 3完了時**: 初回マージ検討（基本機能確認）
- **全Stage完了時**: 最終マージ実行

### マージ準備完了報告
```
「全Stage完了しました。phase3_demo へのマージ準備が整いました。
マージ実行の指示をお待ちしております。」
```

**重要**: マージは人間が手動で実行、エージェントは準備完了報告のみ